10 '  "WORLD" Map
12 CLEAR256,62920:DEFINTI,J,N,X,Y,A
14 DIM N(3):I=0:J=0:X=43:Y=28:XS=43:YS=28:B$=SPACE$(15)
16 B=63792:S=62920:PI=2*ATN(1E30):DPR=180/PI:KX=(360/128)/DPR
18 XZ=-5:' M-100 time-zone (Eastern=-5, Central=-6, ...)
20 FORI=0TO33:READJ:POKES+I,J:NEXTI:CLS:GOTO600
22 IFPEEK(B)AND1THENPSET(X,Y):PSET(XS,YS)ELSEPRESET(X,Y):PRESET(XS,YS)
24 A$=INKEY$:IFA$=""THEN22
26 A=ASC(A$):IFA<28ORA>31THEN38
28 PRESET(X,Y):IFA=28ANDX<127THENX=X+1
30 IFA=29ANDX>0THENX=X-1
32 IFA=30ANDY>0THENY=Y-1
34 IFA=31ANDY<63THENY=Y+1
36 PSET(X,Y):PRINT@225,B$;:PRINT@264,B$;:PRINT@304,B$;:GOTO22
38 A=INSTR("LlMmSsDdRr",A$)
40 ONAGOTO50,50,300,300,400,400,500,500,600,600:GOTO22
50 Y$="N":IFY>38THENY$="S"
52 X$="W":IFX>59ANDX<124THENX$="E"
54 YW=Y:GOSUB100:I=INT(ABS(LW)*DPR+.5)
56 XW=X:GOSUB200:J=INT(ABS(GW)*DPR+.5)
58 PRINT@225,Y$;I;"  ";X$;J;"  ";
60 JZ=0:IFJ>7THENJZ=1+(J-7.5)/15:' Print local day/time
62 IFX$="W"THENJZ=-JZ
64 T$=TIME$:XD=PEEK(63787):XH=VAL(LEFT$(T$,2))+JZ-XZ
66 IFXH>23THENXH=XH-24:XD=XD+1:IFXD=7THENXD=0
68 IFXH<0THENXH=XH+24:XD=XD-1:IFXD=-1THENXD=6
70 IF I>63ANDJ>169ANDX$="W"THENXD=XD+1:IFXD=7THENXD=0
72 AD=6520+3*XD:Z$=CHR$(PEEK(AD))+CHR$(PEEK(AD+1))+CHR$(PEEK(AD+2))
74 H$=RIGHT$(STR$(XH),2):IFXH<10THENH$="0"+RIGHT$(H$,1)
76 PRINT@264," "+Z$+" "+H$+RIGHT$(T$,6)+"  ";:GOTO22
100 LW=ABS(YW-38.5):' Latitude
104 LW=2*ATN(EXP(LW/19.8))-PI/2:IFYW>38.5THENLW=-LW
108 RETURN
200 GW=KX*(XW-59.5):IFXW>123THENGW=GW-2*PI:' Longitude
206 RETURN
300 MENU:' Exit
400 PRESET(XS,YS):XS=X:YS=Y:GOTO50:' Save Point
500 YW=YS:GOSUB100:L1=LW:YW=Y:GOSUB100:' Distance
508 L2=LW:XW=XS:GOSUB200:G1=GW:XW=X:GOSUB200
516 DG=G1-GW:C=SIN(L1)*SIN(L2)+COS(L1)*COS(L2)*COS(DG)
520 D=ATN(SQR(1-C*C)/C):IFD<0THEND=PI+D
524 D=INT(D*DPR*60+.5):PRINT@304,"Dist:";D;"nmi";:GOTO22
600 CLS:RESTORE900:' Draw Map
604 FORI=0TO127:FORJ=0TO3:READN(J):NEXTJ:CALLS,I,VARPTR(N(0)):NEXTI
700 PRINT@28,CHR$(155)+"  "+CHR$(154)+"  "+CHR$(152)+"  "+CHR$(153)
704 PRINT@64,"<L>ocate  <S>ave":PRINT@107,"<D>istance"
710 PRINT@144,"<R>edraw  <M>enu":GOTO22
800 ' "Plot Column" M/L Sub
802 DATA 87,30,63,6,8,126,229,14,8,7,210,222,245,245,197,213,205,76,116,209
804 DATA 193,241,29,13,194,209,245,225,35,5,194,205,245,201,77,66,69,201
900 ' "World" Data
902 DATA 0,0,256,-32768,0,0,0,-24563,0,0,64,22674,0,8256,128,2128
904 DATA 0,0,128,1072,0,0,0,2120,0,0,0,2064,0,0,0,2056
906 DATA 0,16,0,4104,0,32,0,4104,0,2,0,4112,0,0,0,8224
908 DATA 0,128,0,4288,0,0,0,4224,0,0,768,2048,0,0,1024,4096
910 DATA 0,0,-2047,-27903,0,0,2,-28416,0,0,4,9736,0,0,24,17932
912 DATA 0,0,56,23300,256,0,64,-28144,0,0,192,27648,0,0,128,18688
914 DATA 0,256,256,768,0,256,624,30736,0,256,136,18732,0,-32000,4104,12355
916 DATA 0,768,2184,-23680,0,1536,26640,25730,0,3072,12568,31107,2048,-30719,17060,2560
918 DATA 0,30726,8579,2813,31,2072,-32704,-2555,-992,1296,16384,2058,860,2272,9216,-26606
920 DATA -32765,2304,6656,24615,16384,2048,8708,-16272,8208,4608,512,16512,14336,4096,3840,128
922 DATA 2048,8192,2048,2304,1024,24576,0,25088,768,-32768,0,-25593,0,-32640,0,8
924 DATA 0,-32704,0,12,0,113,0,3,0,13,0,-32768,32,2,0,16384
926 DATA 0,0,0,8192,0,0,0,4096,128,0,0,5376,1,256,0,-30208
928 DATA 0,0,0,1025,0,0,16,-32766,0,1792,192,-32767,8192,2048,32,0
930 DATA 0,4096,16,0,0,4096,-16115,1156,0,4096,16387,0,0,4096,-17659,96
932 DATA 0,2048,19202,128,0,4096,9218,0,0,4096,-24062,28,0,-8192,8450,210
934 DATA 32,57,20741,-32735,256,710,-24311,16492,3584,0,16648,12435,2048,0,-32763,-28544
936 DATA 2048,0,16392,18510,1024,0,24584,-30663,1024,-32767,-28663,2068,768,-32766,-30711,4116
938 DATA 0,236,22585,-12279,0,19,18679,24582,0,-31988,12480,16385,0,18176,0,-32768
940 DATA 0,10976,0,24576,0,6704,28688,16384,0,2304,-12239,-24576,0,257,16480,18176
942 DATA 0,64,224,8192,0,0,8224,10240,0,0,12320,4096,0,0,32,4096
944 DATA 8,0,64,15360,0,9217,128,17152,0,1792,0,31744,0,3072,6144,5376
946 DATA 0,1536,2048,25600,0,6400,0,1280,0,0,128,768,0,0,64,0
948 DATA 0,0,64,0,0,0,128,0,0,16640,0,0,0,-29184,0,0
950 DATA 0,13313,0,0,0,18690,1152,0,0,1540,832,768,0,-32763,128,256
952 DATA 768,-32763,64,0,7168,16512,66,768,4096,-32640,45,512,4096,1603,-32592,512
954 DATA 2048,-18392,1,512,2048,34,7,1536,2048,21,-32752,2048,4096,8211,-32760,3072
956 DATA 8192,51,16644,2048,8192,69,15876,2176,16384,54,-32766,1344,16384,1062,-8704,1056
958 DATA 16385,8268,0,1056,12544,138,16384,3104,3584,8202,128,2112,16,4,4096,2080
960 DATA 0,8200,1792,6288,0,0,256,8400,4,4256,0,8224,4,0,256,8224
962 DATA 2,8192,0,16416,-32767,0,1024,8208,-32768,1,0,8204,0,64,1024,8202
964 DATA 1024,0,528,17409,0,64,0,16385,0,33,544,-32768,0,0,0,66

