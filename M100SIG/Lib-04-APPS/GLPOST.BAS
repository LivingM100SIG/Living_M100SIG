10 MAXFILES=3:GOTO5010
20 CLS:PRINT@135,"Posting":OPEN"TEMP"FOROUTPUTAS3:OPEN"WTB"FORINPUTAS2
30 OPEN"CJ"FORINPUTAS1:IFEOF(2)THENCLOSE:NAME"WTB.DO"AS"LASTMO.DO":NAME"TEMP.DO"AS"WTB.DO":GOTO5010
40 GOSUB4010
50 GOSUB4500:IFC$<>C2$GOTO50
60 FSUM=FSUM+F:GSUM=GSUM+G:GOTO50
150 X=FSUM:Y=GSUM:V=V+X:W=W+Y:PRINT#3,C2$;",";T$;",";U;V;W;X;Y:FSUM=0:GSUM=0:CLOSE#1:GOTO30
300 OPEN"WTB"FORINPUTAS2:CLS:PRINT@135,"Posting"
310 GOSUB4010:IFC2$<"500"GOTO310
330 VSUM=VSUM+V:WSUM=WSUM+W:IFEOF(2)GOTO370
350 GOSUB4010:GOTO330
370 P=VSUM-WSUM:CLOSE:OPEN"WTB"FORINPUTAS2:OPEN"TEMP"FOROUTPUTAS1
380 IFEOF(2)THENCLOSE:NAME"WTB.DO"AS"LASTYR.DO":NAME"TEMP.DO"AS"WTB.DO":GOTO5010
390 GOSUB4000:IFC2$="410"ORT$="Retained Earnings"THENV=V+P
400 IFC2$<"500"THENU=U+V-W:V=0:W=0:X=0:Y=0
410 IFC2$>="500"THENU=0:V=0:W=0:X=0:Y=0
420 GOSUB4100:GOTO380
500 OPEN"WTB"FORINPUTAS1:INPUT#1,A$,B$:CLOSE:IFA$="000"THENH$=B$
520 IFH$=""THENCLS:PRINT"  Use No Commas":INPUT"Enter Company Name or Title (use no commas)";H$
540 CLS:PRINT"  Use No Commas":INPUT"Enter Time Period";DA$:OPEN"WTB"FORINPUTAS2:S$="######.##":LPRINTDATE$:LPRINTSPACE$((80-LEN(H$))/2);H$
570 LPRINTTAB(29);"Working Trial Balance":LPRINTSPACE$((80-LEN(DA$))/2);DA$:LPRINT:LPRINT:LPRINTTAB(38)"Debits";TAB(52)"Credits":LPRINT:LC=7
590 IFLC>54THENLPRINTCHR$(12):LC=0
600 IFEOF(2)GOTO670
610 GOSUB4010:IFC2$="000"GOTO610
620 LPRINTC2$;TAB(5);T$;:N=0:M=U+V-W:IFM<0THENN=-M:M=0
640 MSUM=MSUM+M:NSUM=NSUM+N:GOSUB4700:GOTO590
670 LPRINTTAB(35);"---------";TAB(50);"---------":M=MSUM:N=NSUM:GOSUB4700:LPRINTTAB(35);"=========";TAB(50);"=========";:LPRINTCHR$(12):GOTO5010
4000 IFEOF(2)GOTO5010
4010 INPUT#2,C2$,T$,U,V,W,X,Y:RETURN
4100 PRINT#1,C2$;",";T$;",";U;V;W;X;Y:RETURN
4500 IFEOF(1)GOTO150
4510 A$=" ":B$=" ":C$=" ":D$=" ":E$=" ":F=0:G=0:INPUT#1,A$,B$,C$,D$,E$,F,G:IF C$="sb"THENGOTO4500
4520 RETURN
4700 IFM>0THENLPRINTTAB(35);USINGS$;M;
4710 IFN>0THENLPRINTTAB(50);USINGS$;N;
4760 LPRINT:LC=LC+1:RETURN
5010 CLEAR:CLS:PRINT"SELECT:":PRINT:PRINTTAB(10)"P]ost Current Period":PRINTTAB(10)"Y]ear End Closing":PRINTTAB(10)"W]TB Print Out":PRINTTAB(10)"E]xit"
5040 ONINSTR("  PpYyWwEe",INKEY$)GOTO5040,5040,20,20,300,300,500,500,5045,5045:GOTO5040
5045 CLOSE:MAXFILES=1:MENU:END
