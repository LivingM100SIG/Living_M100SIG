






                              Lesson 4: Repeating Items

          In the last lesson, we showed an example of a memo ("Mets Game")
          that repeated a dozen times during the summer.  Other
          appointments and memos will repeat more regularly.  Most of us
          simply try to remember these repeating events, such as reports
          due or church functions, but it is better to have them in the
          calendar.  TMPC provides a way that most repeating activities can
          be entered only once; this lesson shows how to use this feature.

          Throughout this lesson, we refer to only a few entries in TOM.DO. 
          There aren't any more examples involving Tom himself.  Enter TMPC
          with TOM.DO still in place, and follow along with the examples
          below.


                                 Example 1: Birthday

          A day which repeats every year is simple to enter with TMPC.  As
          an example, look at the entries for January 11.  The entry "EPG
          b'day" is a repeating entry.  Select it in the appointment-list
          screen and more to the add-appointment screen:



                                      Screen 9
                      ** *************************01/11/84****
                      ** *EPG B'day                       ****
                      ** *                                ****
                      ** *************************************
                        %                                     
                      ** ****** ******* ******* **************
                      **edit***warning*type****repeat*********
                      *********  0*****Cday****mnth***********



          There is a corridor off to the right of this screen that has been
          absent from all the previous items we examined.  The corridor
          leads to the repeating-item screen, where the exact details of
          the repeating item are stored.

          To examine the details for a birthday entry, press [Right-Arrow]
          [Right-Arrow] [Right-Arrow] [Right-Arrow]:







                                      Page: 24





                              Lesson 4: Repeating Items




                                      Screen 14
                      **JanFebMarAprMayJunJlyAugSepOctNovDec**
                      **x** ** ** ** ** ** ** ** ** ** ** ****
                      **                                  ****
                      ** *************************************
                        %                                    *
                      ** ****          x                     *
                      **off************111111111222222222233**
                      *******1234567890123456789012345678901L*



          The x's in the boxes indicate which days and months are active;
          so, the box for "January" and the box for "11" both have x's. 
          You can add (or remove) x's by moving under the respective box
          and pressing [Up-Arrow].  More than one month can be active at
          once; so, you could make the entry "EPG b'day" appear on the
          eleventh of any of the twelve months.  Of course, it makes little
          sense to have a birthday entry for more than once per year.


                             Example 2: Activity Report

          For another example, examine the "activity summary" entry.  (This
          entry is a deadline listed under January 11; move to the
          appointment-list screen and select it; then return to the
          repeating item screen).  The data for the activity summary are:



                                      Screen 14
                      **JanFebMarAprMayJunJlyAugSepOctNovDec**
                      **x**x**x**x**x**x**x**x**x**x**x**x****
                      **                                  ****
                      ** *************************************
                        %                                    *
                      ** ****              x                 *
                      **rev************111111111222222222233**
                      *******1234567890123456789012345678901L*









                                      Page: 25





                              Lesson 4: Repeating Items

          Here, every month is active, meaning that the activity summary is
          due on the 15th of every month.  There is also an indication
          "scan before", which has a special meaning. It means that if the
          15th of the month is not on a business day, the date for that
          month will fall on the last business day before the 15th.  By
          pressing [Down-Arrow], you can select "after" or "none".  With
          "before" selected, the activity summary comes due on Friday,
          January 13.


                              Example 3: J. A. Meeting

          Many repeating events do not fit the pattern of a day (or days)
          of each month.  TMPC offers one other type of repeating: by the
          week.  For an example, select "J.A. Meeting" from January 11 and
          move to the repeating-entry screen:



                                      Screen 13
                      **1**2**3**4**5**L**********************
                      **X**x**x**x**x** **********************
                      **                **********************
                      ** *************************************
                        %                       **************
                      ******* ** ** **x** ** ** **************
                      *******SunMonTueWedThuFriSat************
                      ****************************************



          The format of the screen is similar, and the function is almost
          the same.  "Week" refers to week of the month. There is no
          business-holiday scanning available for this type of repeating
          entry.


          Making New Repeating Entries

          Every entry you create will start as a single entry.  To make it
          a repeating entry, you must move to the far right box in the
          add-appointment screen and press [Down-Arrow] until either
          "monthly" or "weekly" repeating appears.  Then, press
          [Right-Arrow] to enter the repeating-item screen and adjust it as
          you wish.






                                      Page: 26







                               Lesson 5: File Handling

          TMPC deals with two different types of data files.  This lesson
          discusses these files and how you can manipulate them.  The
          lesson also covers the subject of multiple machine language
          files.


                                    The Task File

          The Task File contains all your to-dos, appointments, memos, and
          repeating items.  TOM.DO is a task file.  You can select the task
          file while in TMPC.  To do this, enter TMPC and press
          [Down-Arrow] [Down-Arrow] [Down-Arrow] [Left-Arrow] [Down-Arrow]. 
          TMPC will prompt you, "Task File?"  Key in the name of the task
          file you want to use, and press [ENTER] (it isn't necessary to
          add ".DO").  If you type a nonexistent file name, TMPC will
          create an empty task file for you.

          TMPC will always initialize new task files to "today", or the
          value of DATE$.  Make sure that DATE$ is correct before creating
          a new task file.


                                   The Diary File

          The Diary file archives all of your past appointments and to-dos. 
          It is updated only when you enter TMPC and DATE$ has changed, or
          when you specify a new task file.  When you first enter TMPC with
          TOM.DO, TMPC creates a diary file from an imaginary January 10,
          1984.

          The Diary file is always called DIARY.DO.  If you just finished
          the other lessons in the tutorial, examine DIARY.DO and get
          familiar with its format. You can change it as you wish; TMPC
          never looks at old diary records to check their format.  The
          format is design to be easy to process, not to look pretty; this
          way, you can use a custom-made BASIC program (or whatever) to fit
          it exactly to your needs.  An example BASIC program comes on your
          tape, called DFORM.BA. It sends a "beautified" form of the diary
          to any output device (screen, line printer, etc.)










                                      Page: 27





                               Lesson 5: File Handling

          Once TMPC enters an appointment into DIARY.DO, it deletes it from
          the task file.  Normally, this is just what you would want  - but
          if you accidentally set DATE$ too far ahead, you can really
          damage your task file by deleting all of your dated items!  As a
          check against this, TMPC will ask you to verify the date if it is
          more than one day ahead of the last activation date.  To see and
          example, set DATE$ to "01/13/84" in BASIC and enter TMPC using
          TOM.DO.  You will see the question:


          Last Day 01/11/84
          Today is 01/13/84
          Proceed?


          If you answer "no", you will exit the program, presumably to fix
          DATE$.  There will be plenty of occasions where it is OK to
          answer "yes" (or just "y"), such as after a weekend.


                               Machine Language Files

          If TMPC is your only machine language file, you can skip this
          section.  You can continue indefinitely using TMPC.BA to run TMPC
          from the menu without any problems at all.  However, if you
          commonly use other machine language programs on the Model 100,
          this section will contain some useful information.

          Unless you know something about machine language programming, the
          problems of multiple machine language programs may seem arcane or
          ridiculous.  However, the problems are real, as so it the danger
          to your files.  If you are careless or hasty, you could lose
          every file on your Model 100.  The basic problem is this: a
          machine language program on the Model 100 must occupy exactly the
          same memory locations every time it runs.  Further, machine
          language programmers write different programs to occupy the same
          locations.

          The most convenient locations for machine language programs on
          the Model 100 is between HIMEM and MAXRAM.  With very few
          exceptions, every machine language program must be in that area
          to run correctly.  MAXRAM is fixed; you can set HIMEM with the
          BASIC CLEAR command.  If HIMEM is set about the "top" address of
          a machine language program, you cannot run it or even load it. 
          The memory between HIMEM and MAXRAM is called "reserved" memory;
          it is useless to BASIC programs or any files at all; and , of
          course, it can (in general) hole only one machine language
          program at a time.



                                      Page: 28





                               Lesson 5: File Handling

          The cassette recorder is one way you can use more than one
          machine language program.  However it is just too slow to use
          every time you want to run TMPC (and probably many other
          programs).  The Model 100 also allows you to save machine
          language files into RAM files - which are different from reserved
          memory.  When you select a CO file from the menu, the Model 100
          copies its contents into reserved memory and runs the program
          there.  This solution is great if you have lots of memory.  You
          must have the memory reserved (with the CLEAR command) before you
          run the CO file, or the Model 100 just beeps and returns you to
          the menu.

          However, if you're like most Model 100 users, you count your
          bytes closely.  Many users have rejected machine language
          programs because they use memory "twice" - once in reserved
          memory, and once in the CO file.  Other users keep only one
          machine language program in reserved memory, and keep the others
          on cassette.  We recommend this course if you seldom use machine
          language programs other than TMPC.


                                FUTIL.BA Description

          However, TMPC comes with a BASIC program, FUTIL.BA, which allows
          you to load machine language programs into reserved memory
          without reserving the memory first.  If you're curious how it
          works, read the program; we won't explain it here.  But we will
          discuss how to use it.


             # Load FUTIL from the TMPC tape into BASIC (using CLOAD
               "FUTIL").

             # Determine the TOP, END, and EXE values for each of your
               machine language programs.  You can find these out by
               loading them from cassette (CLOADM always prints the values)
               or from the programs' user manuals.  You also must determine
               whether a CALL statement from BASIC can run the program
               correctly - normally, the answer is "Yes"

             # Type EDIT to change the FUTIL program; once in the program
               editor, type [CTRL-Z] to move to the bottom of the file.

             # Add one DATA statement for each of your machine language
               programs, following the format shown in the program file.

             # Use [F8] to exit the editor, and use SAVE "FUTIL" to save
               the program.  You may also want to save the changed program
               to cassette or disk.


                                      Page: 29





                               Lesson 5: File Handling


          You are now ready to run FUTIL.  When you run it, it will prompt
          you: 


          (L)oad or (S)ave?


          If there is no reserved memory, you can only Load; you won't see
          this prompt.  Load moves a CO file into reserved memory, which
          will cause you to lose whatever was in reserved memory.  Save
          creates a CO file from reserved memory and also "unreserves" it,
          leaving it clear for your BASIC programs or files.

          After you type "L" or "S", FUTIL will prompt you "file name?" 
          You must answer with one of the files in DATA statements below. 
          After that, it will either do the load or save, or complain that
          something is wrong - for example, no DATA statement, no CO file,
          not enough memory, etc.  These messages are all pretty much
          self-explanatory.

          Some machine language programs will not work with FUTIL. 
          Anything that changes the BASIC expansion latches (e.g., Pro Aid
          or Supera by Micro Demon, or Radio Shack's bar code software)
          should be handled very carefully.  Any program which requires
          HIMEM to be lower than TOP to run (which is foolish and probably
          rare) will not work.

          All these warnings should make you careful.  We do not want you
          to lose any data; we wish the Model 100 had limitless memory, but
          it doesn't.

          To review, we will present an example.  Suppose that Tom has a
          word-processing program WORDCOMET- which is written in machine
          language.  When Tom first bought TMPC, he loaded FUTIL.BA from
          tape, then loaded WRDCMT off cassette (with CLOADM).  He got the
          following printout:


          Found: WRDCMT
          TOP: 60161
          END: 62915
          EXE: 60535


          Tom edited FUTIL to show the appropriate data statements for
          WORDCOMET-.  He adds the line:


          1010 DATA "WRDCMT",60161,62915,60535,"Y"

                                      Page: 30





                               Lesson 5: File Handling



          Then, he ran FUTIL.  Since he just loaded WORDCOMET- from
          cassette, he responds "S" to the prompt, then "WRDCMT" to the
          "filename" prompt.

          Then, Tom loaded TMPC and began using it.  When time comes to
          format some text with WRDCMT, he takes the following steps:


             # He runs FUTIL and responds "S"to the prompt, then enters
               "TMPC".

             # At the next FUTIL prompt, "file to load", he enters
               "WRDCMT".  When asked, "Execute?" he enters "y" to run it.

             # WORDCOMET- returns Tom to the Menu after it runs.  Although
               TMPC.BA is still there, Tom knows that it will not work; he
               first must return TMPC to reserved memory.  So, he (S)aves
               WRDCMT and loads TMPC.  Since he doesn't need TMPC right
               now, he responds "n" to the "Execute?" prompt.


          We hope we haven't confused you with this last section.  It can
          be confusing at first, so don't be frustrated.  Follow the
          instructions carefully, and if you get stuck, consult a friend
          who knows something about machine language programming.  They
          will be able to make better sense out of this section.























                                      Page: 31
