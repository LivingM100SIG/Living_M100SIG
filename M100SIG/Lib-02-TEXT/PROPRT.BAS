10 MAXFILES=1
20 CLS:DEFINTL-Z:DEFSTRA-K
30 INPUT"Which File";FL
40 INPUT"Left Margin";Y
50 INPUT"Character Width";Z:LZ=12*Z
60 IFZ+Y>80GOTO40
65 INPUT"Proportional";H:IFINSTR("Yy",H)THENP=1::LPRINTCHR$(27)"p1";:' Code for Proportional print
70 OPENFLFORINPUTAS1
80 IFEOF(1)THENLPRINTCHR$(27);"p0";CHR$(12):CLOSE:MENU:END
85 A=INPUT$(1,1):IFPTHENGOSUB1500ELSELA=12
86 IFA=CHR$(10)THENA="":GOTO80
90 IFA=CHR$(13)THENGOSUB500:GOTO80
100 B=B+A:LB=LB+LA
110 IFA=CHR$(32)GOTO130
120 GOTO80
130 IFLZ<(LB+LC)THENGOSUB300:GOTO80
140 C=C+B:LC=LC+LB:B="":LB=0
150 GOTO80
290 '
292 '
294 '
300 GOSUB700
310 L=LEN(C):M=(LZ-LC)/(L-1)' Count extra incremental spaces and divide by inter-character spaces
320 N=(LZ-LC)MOD(L-1)' Count remainder of previous division
340 GOSUB600:LPRINTCHR$(27)" "CHR$(M+1); 'send code for extra incremental spaces
345 LPRINTLEFT$(C,N);' print leftmost part of string
350 LPRINTCHR$(27)" "CHR$(M); 'decrease space increment by one
355 LPRINTMID$(C,N+1) 'print rest of string
360 C=B:LC=LB:B="":LB=0
410 LI=LI+1
420 IFLI=55THENLPRINTCHR$(12):LI=0
430 RETURN
440 '
441 '
442 '
500 IF(LC+LB)>LZTHENGOSUB300ELSEC=C+B:LC=LC+LB:B="":LB=0
510 IFLC+120<LZTHENGOSUB600:LPRINTC:GOSUB360:RETURN
520 GOSUB300:GOSUB700
530 RETURN
540 '
590 '
591 '
592 '
600 LPRINTCHR$(27)" "CHR$(0);SPACE$(Y);:RETURN' Print left margin
690 '
700 IFRIGHT$(C,1)=" "THENC=LEFT$(C,LEN(C)-1):LC=LC-LA:GOTO700
705 IFLEFT$(C,1)=" "THENC=MID$(C,2):LC=LC-LA:GOTO705
710 IFC=""GOTO80
720 RETURN
900 '
901 '
902 '
903 '
1500 IFINSTR("!'`|",A$)THENLA=5:RETURN
1510 IFINSTR("().:;",A$)THENLA=6:RETURN
1520 IFINSTR(",",A$)THENLA=7:RETURN
1530 IFINSTR("1I[]il",A$)THENLA=8:RETURN
1540 IFINSTR("j{}",A$)THENLA=9:RETURN
1550 IFINSTR("/<>XZ\fkxz",A$)THENLA=10:RETURN
1560 IFINSTR("Jbcdghnpqrt",A$)THENLA=11:RETURN
1570 LA=12:RETURN
