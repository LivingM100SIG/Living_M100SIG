0 CLEAR2000,62894:GOSUB 170'ML SUPPORT
1 MAXFILES=4:DEFINTA-Z:DEFSTRS:S=SPACE$(255):SE=CHR$(27):SY=SE+"Y":SR=CHR$(13)+CHR$(10):DIMSB(10,1):ONERRORGOTO97:PD=PEEK(MAXRAM):PD=-PD*(PD=195ORPD=73)
4 SF="":PA=0:GOSUB90:GOSUB95:SD=SI:CO=1:GOSUB130:IFF=0ANDDP=0THENSI="Number copies	   1=":GOSUB87:CO=VAL(SI):CO=CO-(CO=0):ML=0:GOSUB36
6 FI=1:ST=SD:GOSUB44:PRINT"Printing Copy"CO:FL=66:PL=56:L0=10:LM=-10*(F<>1):IN=0:RM=75+L0*(F=1):LL=RM:LS=1:LC=1:PI=5:PS=0:PG=1:GOSUB135:LF=1:P0=0:RF=1:UB=0:IB=0:DB=0:PX=0:PZ=0:SH="":GOSUB 145
17 IFLC+I>PLTHENGOSUB110:LC=LC+1:GOSUB37:RETURN
18 FORI1=1TOI:GOSUB115:NEXT:LC=LC+I:IFF=2THENPRINTSTRING$(I,10);:RETURNELSERETURN
30 I=LC+LS>PL:GOSUB120:LC=LC+1-(LS-1)*(I=0):IFITHENGOSUB37
34 I=FL-LC+1:IFLEN(SF)THENGOSUB125ELSEGOSUB18
35 PG=PG+1:GOSUB 135:GOSUB145:LC=1:P0=1:IFPA=0THENRETURN
47 CLOSE:IF DP=0 THEN SI=SD+" complete":GOSUB87:RUN1ELSE GOSUB 160:RUN1
70 PG=V1:GOSUB135:RETURN
78 IFF OR DP THENRETURNELSESI="PAUSE: "+SA:GOSUB87:RETURN
90 SI="To: Line Printer=P  or Dev:Filnam.Ext"+SR+"DISP or  Quit=":GOSUB87:SO=SI:GOSUB 140:IF DP THEN RETURN
91 IFSI=""THEN96ELSEF=INSTR("LPT:COM:CRT:LCD:",LEFT$(SO,4)):IFF=0ORF>5THENF=2+(F>5):GOTO93ELSEGOSUB99:IFF<3THENSO="LPT:":IF(INP(187)AND6)<>2THENSI="Printer not ready":GOSUB87:GOTO90
92 F=0:SI=SP+" printer-run PRTFIX to change"+SR+"Paper: single=S continuous=":GOSUB87:PA=(SI="S")
93 OPENSOFOROUTPUTAS2:ST=SO:FI=2:GOSUB100:IFLEN(SU)THENPRINT#2,SU;:RETURNELSERETURN
94 SI="Invalid output device":GOSUB87:GOTO90
95 CLS:FILES:SI="Document Name"+SR+"   Quit=":GOSUB87:IFSI>""THENPRINT:RETURN
96 CLOSE:IFPD=195THENMAXFILES=1:CLEAR256,MAXRAM:LFILESMENUELSEMAXFILES=1:CLEAR256,MAXRAM:MENU
97 ER=ERR:IFERL=40ORERL=44THENRESUME45ELSEIFERL=92THENRESUME93ELSEBEEP:ONERRORGOTO1
105 'MODIF 7/14/87.1 (PTXTX.ML) J Holovacs 74756,413-lines 0,1,4,6,17,18,30,34,35,47,70,78,90-97,105+
110 IF DP THEN RETURN
113 IFPQTHENPRINT#2," "SB
114 RETURN
115 IF DP THEN RETURN
116 IFPQTHENPRINT#2,SB
119 RETURN
120 IF DP THEN 150 ELSE IFPQTHENPRINT#2,SPACE$(II)LEFT$(S,P)STRING$((LS>1)*(LS-1)*(I=0),10)" "SB
121 RETURN
125 IF DP THEN RETURN
126 IFPQTHENPRINT#2,SF;
128 RETURN
130 CLS:PG$="A":PRINT"Pages--separated by spaces or":INPUT "[enter]=ALL";PG$:PG$=" "+PG$+" ":RETURN
135 IFPG$=" A " THEN PQ=1:RETURN
139 PQ=INSTR(1,PG$,STR$(PG)+" "):RETURN
140 IF SO="DISP"THEN DP=1 ELSE DP=0 'set display flag
141 RETURN
145 IF DP=0 OR PQ=0 THEN RETURN
146 IF DP<>1 THEN BEEP:PRINT @ 260,"Hit key for next";:R$=INPUT$(1)'ignore on first page
148 CLS:LINE(9,0)-(9,63):LINE(91,0)-(91,63):PRINT @300,"Page:";PG;:DP=-1
149 RETURN
150 'draw line
151 IF LC>64 THEN RETURN
152 IF PQ=0 THEN RETURN
153 D$=SPACE$(II)+LEFT$(S,P)
156 CALL 62898,LC,VARPTR(D$)
159 RETURN
160 IF PQ=0 THEN PRINT@220,"hit any key";:R$=INPUT$(1)
162 RETURN 'clean up act if last page
170 'ML SUPPORT
172 READP,Q,R:C=P+Q+R
176 FORJ=PTOQ:READX:C=C+X:POKEJ,X:NEXT:READZ
178 IFC<>ZTHENSOUND9394,9:PRINT"Checksum is wrong":END
180 RETURN
184 DATA62895,62957,62898
188 DATA0,0,0,254,65,208,61,50,175,245,62,9,50,177,245,126
190 DATA254,0,200,50,176,245,35,94,35,86,235,126,229,254,33,218
192 DATA220,245,58,177,245,87,58,175,245,95,205,76,116,33,176,245
194 DATA53,202,236,245,33,177,245,52,225,35,195,202,245,225,201,197774
