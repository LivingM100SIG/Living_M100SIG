0 'Prints Data files in columns
1 'Ron Bean 2/86
2 'NOTE: Set MAXFILES to one more than # of columns. T,B,PL are Top,Bottom margins & Page Length. Does not format.
10 MAXFILES=5:T=5:B=5:PL=66:L=PL-B:CLS:FILES:INPUT"filename";F$
20 INPUT"# of Cols";C:INPUT"Col width";W:INPUT"# spaces bet. cols";S:INPUT"Left margin";M:PRINT"Total line length is ";C*(W+S)+M-S:INPUT"Is this OK";K$:IFK$="y"ORK$="Y"THEN30ELSE20
30 INPUT"Starting page #";P:INPUT"Pause bet. pages";P$:INPUT"Enter Title";T$
40 ONERRORGOTO110:S$=SPACE$(S):M$=SPACE$(M):W$=SPACE$(W)
41 OPENF$+".DO"FORINPUTAS1
45 FORI=0TOC-2:C$(I)="RAM:C"+STR$(I)+".DO":NEXT
50 PRINT"Columnizing page ";P:FORI=0TOC-2:OPENC$(I)FOROUTPUTAS2:FORJ=1TOL-T-1:IFEOF(1)THENPRINT#2,W$ELSELINEINPUT#1,X$:Y$=W$:MID$(Y$,1)=X$:PRINT#2,Y$
60 NEXT:CLOSE2:NEXT
70 PRINT"Printing page ";P:LPRINTSTR$(P)+"  "+T$+"  "+DATE$:FORI=1TOT-1:LPRINT:NEXT:FORI=2TOC:OPENC$(I-2)FORINPUTASI:NEXT
80 FORI=1TOL-T-1:LPRINTM$;:FORJ=2TOC:LINEINPUT#J,X$:LPRINTX$+S$;:NEXT:IFEOF(1)THENY$=W$ELSELINEINPUT#1,X$:Y$=W$:MID$(Y$,1)=X$
90 LPRINTY$:NEXT:FORJ=2TOC:CLOSEJ:NEXT:FORI=1TOB:LPRINT:NEXT:IFEOF(1)THENFORJ=0TOC-2:KILLC$(J):NEXT:CLOSE1:BEEP:MENUELSE:P=P+1:IFP$="Y"ORP$="y"THENBEEP:PRINT"READY FOR PAGE--PRESS ANY KEY"
100 K$=INKEY$:IFK$=""THEN100ELSE50
110 IFERL=40THENPRINT"No file "+F$:INPUT"filename";F$:RESUME40ELSEIFERR=7THENPRINT"OUT OF MEMORY":ENDELSEPRINT"ERROR # ";ERR:END
