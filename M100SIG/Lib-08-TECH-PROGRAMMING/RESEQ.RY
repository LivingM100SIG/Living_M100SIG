1 CLEAR999:MAXFILES=2:DEFSTRD-I:FILES:INPUT"File";F:GOSUB8
2 LINEINPUT#1,E:IFNOTEOF(1)THENZ=Z+1:GOTO2
3 DIMA(Z):GOSUB8:INPUT"1st #";M:INPUT"Inc";K:FORY=0TOZ:LINEINPUT#1,E:A(Y)=VAL(E):NEXT:GOSUB8
4 OPEN"x"FOROUTPUTAS2:FORY=0TOZ:LINEINPUT#1,E:E=MID$(STR$(M+K*Y),2)+MID$(E,LEN(STR$(VAL(E)))):RESTORE:FORS=1TO6:J=1:READD
5 J=INSTR(J,E,D):IFJTHENJ=J+LEN(D)ELSENEXT:PRINT#2,E:NEXT:BEEP:CLOSE:KILLF:NAME"x.do"ASF:MENU
6 H=MID$(E,J,1):IFH=" "ORH=","THENJ=J+1:GOTO6ELSEIFH<"0"ORH>"9"THEN5ELSEV=VAL(MID$(E,J)):W=LEN(STR$(V))-1:C=-1
7 C=C+1:IFC>ZTHEN?E;TAB(J-1)"^bad#":ENDELSEIFV=A(C)THENG=STR$(M+K*C):E=LEFT$(E,J-1)+MID$(G,2)+MID$(E,J+W):J=J+LEN(G):GOTO6ELSE7
8 CLOSE:OPENFFORINPUTAS1:RETURN:DATAGOTO,GOSUB,THEN,ELSE,RESTORE,RESUME
