0 'QKRCHK.200 -- Creates QRKCHK.CO for    the Tandy 200. Purely M/L checksum      calculator. Run from menu or in Basic
1 'Can be used while on line with DIRACC  or XMDPW5.CO.  Ignore syntax error.     Phil Wheeler - 71266,125 [12/27/87]
2 GOSUB99
3 B=63574
6 CLS:PRINT"        Creating QKRCHK.CO";:A=B:C=B+E:D=D+B:S=99:M=99:PRINT@88,"Line";:PRINT@128,"Address";
7 GOSUB60:IFO=0THENPOKEA,K:A=A+1:GOTO7
8 P=K:GOSUB60:G=P+256*K+B:P=INT(G/256):Q=G-P*256
9 POKEA,Q:A=A+1:POKEA,P:A=A+1:GOTO7
40 SAVEM"QKRCHK",B,C,D:MENU
50 U=INSTR(1,Z,MID$(Y,M,1)):IFU=0THEN55
51 IFU>16THENU=U-16:O=1ELSEO=0
52 V=INSTR(1,Z,MID$(Y,M+1,1)):IFV=0ORV>16THEN55
53 K=(U-1)*16+V-1:RETURN
55 BEEP:PRINT@205,"Bad character";:END
60 IFM<N*2+5THEN70
61 IFL<>RTHENBEEP:PRINT@205,"Checksum fail";END
62 READY:M=1:GOSUB50:IFK=0THEN40
63 S=S+1:PRINT@110,S;:PRINT@150,A;:N=K:M=3:GOSUB50:M=5:L=K:GOSUB50:L=K*256+L:R=0
70 M=M+2:GOSUB50:R=R+K:RETURN
99 DEFINTI-X:DEFSTRY-Z:Z="0123456789ABCDEFGHIJKLMNOPQRSTUV":CLS:E=291:D=0:RETURN
100 DATA384E1DCD4D4FCD2A2A2154F9CD9E67CDF654D7C82170EFE52B23CD131077FE2ECA7AF8B7C26CF81150F90604CDBA41D13E0ACD4F6ECA16F9CD8C6E
101 DATA38211DEBAF6F674F1A13FE0DCA93F8FE0ACA93F8FE1ACAAFF8D55FAF5719894FD1C393F81177F9EB7323722371016EF9212BF93E3002E51177F91A
102 DATA387C13961213231A9E1213231A9E12E10A3C02D2C1F83D021177F91A861213231A8E1213231A8E120323AFBEC2BEF816043E30216EF9BEC204F936
103 DATA389B1C202315C2F9F82164F9CD9E672144F9CD9E67CDE572C356F821166FCD9E67CD454F2144F9CD9E67CDE572C356F880969840420FA086011027
104 DATA386D0D00E803006400000A0000010000005461702053504320426172002E444F0046696C653F203C43523D456E643E2000436865636B73756D203D
105 DATA0C0000000000000000000000000000
106 DATA00
