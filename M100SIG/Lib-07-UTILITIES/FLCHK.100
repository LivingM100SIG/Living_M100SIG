0 'FLCHK.100 -- Basic loader to create a Model 100/102 version of James Yi's FLCHK.200
1 'Do CLEAR 256,MAXRAM before running to put at top of user RAM. Phil Wheeler - 71266,125 [6/19/88]
2 GOSUB99
3 PRINT@42,"Enter end address";:PRINT@82,"<ENTER> for just below current HIMEM"
4 Y="":PRINT@122,SPACE$(30);:PRINT@122,;:INPUTY:IFY=""THENB=HIMEM-E-1ELSEB=VAL(Y)-E
5 IFB>=MAXRAM-ETHENBEEP:GOTO4ELSECLEAR256,B:B=HIMEM:GOSUB99
6 CLS:A=B:C=B+E:D=D+B:S=99:M=99:PRINT@48,"Line";:PRINT@88,"Address";
7 GOSUB60:IFO=0THENPOKEA,K:A=A+1:GOTO7
8 P=K:GOSUB60:G=P+256*K+B:P=INT(G/256):Q=G-P*256
9 POKEA,Q:A=A+1:POKEA,P:A=A+1:GOTO7
40 SAVEM"FLCHK",B,C,D:MENU
50 U=INSTR(1,Z,MID$(Y,M,1)):IFU=0THEN55
51 IFU>16THENU=U-16:O=1ELSEO=0
52 V=INSTR(1,Z,MID$(Y,M+1,1)):IFV=0ORV>16THEN55
53 K=(U-1)*16+V-1:RETURN
55 BEEP:PRINT@165,"Bad character";:END
60 IFM<N*2+5THEN70
61 IFL<>RTHENBEEP:PRINT@165,"Checksum fail";END
62 READY:M=1:GOSUB50:IFK=0THEN40
63 S=S+1:PRINT@70,S;:PRINT@110,A;:N=K:M=3:GOSUB50:M=5:L=K:GOSUB50:L=K*256+L:R=0
70 M=M+2:GOSUB50:R=R+K:RETURN
99 DEFINTI-X:DEFSTRY-Z:Z="0123456789ABCDEFGHIJKLMNOPQRSTUV":CLS:E=554:D=0:RETURN
100 DATA385C18CD3A1FCD462121H902010800CD666321VF01CDA211CD3E46D7C8DAM000CDFA21CD0B4CCDAF20CAG3007EF5D5CDM301444DD1F132I902FEC0
101 DATA383917CAO300FEA0CAL700ED7CB5CAV000131313131A13B7CAK0001BCDP300C3KA00131313131313C3O300E5D7DAM100AF32I90277EBE1D5CDEB08
102 DATA38661AE1362CD5CDEC08EBC1C50823E5EBCDPE01C1D13E8532IA0278B1CAV000CDP300C3O8000B3AI902FEC01A13C2R40021IA02FE0DCAU700D5C5
103 DATA38F519F5B7FCL70135CCLD01F1C1D1C54721I00278B7C1C8C5470E01FE0ADAT1002B0E0AFE64DAT1000E642B3491D2T1008147357EFE0ADAR600D6
104 DATA38B5140A772B34C3T9001AFE0AC0130B3685C92185F6E5CDFA21160019363A2311E8FB0606CD6934362F23EB21GF02CDA21121H802237EB73E30FA
105 DATA385A14I101CAH2017E23C630E712137E3CC2HD01EB360D23360AC108C5444D03C521I202CD0622CD2D6BC1CD6D6BD1D2L00121B160CD9157C3G300
106 DATA38A31D41CD6934C3G300111E1EC3TB0111C81EC3TB017ECDE35AFEA0CAP901FEB0CAS101FEF0CAS101FEC0CAOB01E5EBCDF405D17D935F7C9A571B
107 DATA38E717C3PE013E1A11FFFFBE2313C2P001C3PE0123235E2356EBE5CDSD014C656E6774683A2000CDD439CDSD01204279746500E17D3DB43E73C444
108 DATA3812204B3A3AF6FE17D03E20E7C3S101E3CDT301E3C97E23B7C8E7C3T301F5D5CD5C7642CD76764BCD577605C2U101D1CDV401F1C3VB01DBBAF620
109 DATA33E00DD3BAC93E0930C90D0A46696C6520746F20636865636B0043686B53756D203D20000000000000000000FF43484B53554D000000
110 DATA00
