0 'LOCK.LDR loads LOCK.CO and LOCKC.CO v3.0 both c1987 Jon Diercks--see LOCK.DOC
1 'LOCK
2 GOSUB99
3 B=64704
6 CLS:PRINT"        Creating LOCK.CO":A=B:C=B+E:D=D+B:S=99:M=99:PRINT@48,"Line";:PRINT@88,"Address";
7 GOSUB60:IFO=0THENPOKEA,K:A=A+1:GOTO7
8 P=K:GOSUB60:G=P+256*K+B:P=INT(G/256):Q=G-P*256
9 POKEA,Q:A=A+1:POKEA,P:A=A+1:GOTO7
40 Z$="RUN200"+CHR$(13):GOSUB80:SAVEM"LOCK",B,C,D:END
50 U=INSTR(1,Z,MID$(Y,M,1)):IFU=0THEN55
51 IFU>16THENU=U-16:O=1ELSEO=0
52 V=INSTR(1,Z,MID$(Y,M+1,1)):IFV=0ORV>16THEN55
53 K=(U-1)*16+V-1:RETURN
55 BEEP:PRINT@165,"Bad character";:END
60 IFM<N*2+5THEN70
61 IFL<>RTHENBEEP:PRINT@165,"Checksum fail";END
62 READY:M=1:GOSUB50:IFK=0THEN40
63 S=S+1:PRINT@70,S;:PRINT@110,A;:N=K:M=3:GOSUB50:M=5:L=K:GOSUB50:L=K*256+L:R=0
70 M=M+2:GOSUB50:R=R+K:RETURN
80 FORZ%=1TOLEN(Z$):POKE65449+2*Z%,ASC(MID$(Z$,Z%,1)):POKE65450+2*Z%,0:NEXT:POKE65450,Z%-1:RETURN
99 DEFINTI-X:DEFSTRY-Z:Z="0123456789ABCDEFGHIJKLMNOPQRSTUV":CLS:E=269:D=61:RETURN
100 DATA38500F0870617373776F72640000000000000000224C4F434B2E434F006B6579776F72643E00206261642074726965732E07000A6C617374207472
101 DATA38BF1A79203D200021D1FCCD781ACD3142CD3F14210408CD7C4221DAFCCD585ACD8FFDCA52FD210408CD7C42CD694221DAFCCD585ACD6E42CD8FFD
102 DATA38B11ACA52FD3AD0FC3C32D0FC2146FF1166FF011F00CDDB6B0605CD294205C248FDC303FDCD4E42CD961A3AD0FCA7CA9757CD3142210408CD7C42
103 DATA38F21A3AD0FC6F2600CDD43921E3FCCD585A210408CD7C4221F0FCCD585A2166FFCD585ACD1053C397572146FFE5061FCD0A4FCD4942CD4272CA9B
104 DATA2E9D1BFDE1FE0DCAB8FD777DFE64C2B0FD3CC93E20E723E5C39BFD2146FF11C1FC3AC0FC471ABEC0231305C2C2FD7EB7C9
105 DATA00
200 'LOCKC
201 GOSUB218
202 B=64704
203 CLS:PRINT"        Creating LOCKC.CO":A=B:C=B+E:D=D+B:S=218:M=99:RESTORE219:PRINT@48,"Line";:PRINT@88,"Address";
204 GOSUB213:IFO=0THENPOKEA,K:A=A+1:GOTO204
205 P=K:GOSUB213:G=P+256*K+B:P=INT(G/256):Q=G-P*256
206 POKEA,Q:A=A+1:POKEA,P:A=A+1:GOTO204
207 Z$="RUNM"+CHR$(34)+"LOCKC"+CHR$(13):GOSUB80:SAVEM"LOCKC",B,C,D:END
208 U=INSTR(1,Z,MID$(Y,M,1)):IFU=0THEN212
209 IFU>16THENU=U-16:O=1ELSEO=0
210 V=INSTR(1,Z,MID$(Y,M+1,1)):IFV=0ORV>16THEN212
211 K=(U-1)*16+V-1:RETURN
212 BEEP:PRINT@165,"Bad character";:END
213 IFM<N*2+5THEN217
214 IFL<>RTHENBEEP:PRINT@165,"Checksum fail";:END
215 READY:M=1:GOSUB208:IFK=0THEN207
216 S=S+1:PRINT@70,S;:PRINT@110,A;:N=K:M=3:GOSUB208:M=5:L=K:GOSUB208:L=K*256+L:R=0
217 M=M+2:GOSUB208:R=R+K:RETURN
218 DEFINTI-X:DEFSTRY-Z:Z="0123456789ABCDEFGHIJKLMNOPQRSTUV":CLS:E=211:D=46:RETURN
219 DATA388A114C4F434B2E434F000C0A6F6C64206B6579776F72643E000D0A6E6577000D0A20202020207665726966793E00000021C8FCCD585A11C0FCCD
220 DATA38BC1DA95ACA6276CDE35A1107001922ECFCCD585A21D7FCCD585A21CDFCCD585ACD5EFD2146FF1166FFCDC36521DDFCCD585ACD5EFD2146FF1166
221 DATA38E01FFF1ABECA3CFDCD6276C3EEFCA7CA45FD2313C331FD2AECFCEB2146FFCDC3652146FFCDFA217B2AECFC2B77C397572146FFE50610CD0A4FCD
222 DATA2CED194942CD4272CA6AFDDA6AFDE1FE0DC282FD2146FF9786CA9757C9FE03CA9757777DFE54C83E20E723E5C36AFD
223 DATA00
