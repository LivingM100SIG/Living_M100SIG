1' BCODE2
2' REWRITE BY PETE FAYTER
3' 	       JULY 21,85
4' CREATES 3 OF 9 CODE ON CGP-115
5'-------------------------------------
10 DEFINT A-Z:CLS:X=0:Y1=0:Y2=-50:C=0
20 LPRINT CHR$(18):LPRINT "I"
40 OPEN "PDAT.DO"FOR INPUT AS 1
45 IF EOF(1) THEN CLOSE 1:GOTO 60
50 A$=A$+INPUT$(1,1):GOTO 45
60 OPEN "PDATA.DO" FOR INPUT AS 1
70 IF EOF(1) THEN CLOSE:LPRINT"A":END
80 B$=INPUT$(1,1):C=C+1
90 PRINT B$;
100 B=ASC(B$)-31:IF B<1 OR B>90 THEN 70
110 I=ASC(MID$(A$,B,1)):IF I=255 THEN70
120 A=128:B(5)=0:FOR X=1 TO 4
130 T=A AND I:A=A/2:IF T>0 THEN T=1
140 IF T>0 THEN B(X)=4 ELSE B(X)=2
150 B(5)=B(5) XOR T
160 NEXT X
170 IF B(5)=0 THEN B(5)=2 ELSE B(5)=4
180 FOR X=1 TO 4
190 T=A AND I:A=A/2
200 IF T>0 THEN S(X)=3 ELSE S(X)=1
210 NEXT X:S(5)=1
300 FOR I=1 TO 5
310 FOR X=1 TO B(I) STEP 2
320 LPRINT"M";X;",";Y1
325 LPRINT"D";X;",";Y2
327 LPRINT"M";X+1;",";Y2
328 LPRINT"D";X+1;",";Y1
330 NEXT X
340 LPRINT"M";X;",";Y1
350 LPRINT"I"
360 LPRINT"M";S(I);",";Y1"
370 LPRINT"I"
380 NEXT
390 LPRINT I
400 IF C>17 THEN 500 ELSE GOTO 70
500 LPRINT"A":FORN=1TO4:LPRINT:NEXT:C=0
510 LPRINT CHR$(18):LPRINT"I":GOTO70
700 DEFINT A-Z:A$="":FOR X= 1 TO 60
720 READ A:A$=A$+CHR$(A):NEXT X
730 OPEN "PDAT.DO"FOR OUTPUT AS 1
740 PRINT #1,A$
750 END
800 DATA 88,255,255,255,14,7,255,255,       255
810 DATA 255,56,11,,255,255,152,13,52,      132,68
820 DATA 196,36,164,100,20,148,84,255,      255
830 DATA 255,255,255,255,255,130,66,194
840 DATA 34,162,98,18,146,82,50,129,65
850 DATA 193,33,161,97,17,145,81,49,136
860 DATA 72,200,40,168,104
