1 CLEARFRE(0)-999:FILES:MAXFILES=1:INPUT"File";N$:OPENN$FORINPUTAS1
2 LINEINPUT#1,Q$:X=X+1:IFNOTEOF(1)THEN2
3 CLOSE:DIMA$(X):X=0:OPENN$FORINPUTAS1
4 X=X+1:LINEINPUT#1,A$(X):IFNOTEOF(1)THEN4
5 PRINTX;"records":CLOSE:W=2^INT(LOG(X))-1
6 FORI=1TOX-W:FORV=ITO1STEP-W:IFA$(V)<=A$(V+W)THEN8
7 Q$=A$(V):A$(V)=A$(V+W):A$(V+W)=Q$:NEXT
8 NEXTI:W=INT(W/2):IFW>0THEN6
9 KILLN$:OPENN$FOROUTPUTAS1:FORY=1TOX:PRINT#1,A$(Y):NEXT:CLOSE:CLEAR0:BEEP:END
